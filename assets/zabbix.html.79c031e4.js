import{_ as a,o as e,c as t,a as i}from"./app.dad05bb1.js";const r="/assets/clipboard.f94b608c.png",s={},n=i(`<h1 id="_1-安装" tabindex="-1"><a class="header-anchor" href="#_1-安装" aria-hidden="true">#</a> 1.安装</h1><h2 id="_1-1官方网站" tabindex="-1"><a class="header-anchor" href="#_1-1官方网站" aria-hidden="true">#</a> 1.1官方网站</h2><p>https://www.zabbix.com/cn</p><h2 id="_1-2-iso-系统-centos-8-0" tabindex="-1"><a class="header-anchor" href="#_1-2-iso-系统-centos-8-0" aria-hidden="true">#</a> 1.2 iso 系统 centos 8.0</h2><h3 id="_1-2-1系统默认登录账号和密码-root-zabbix-网页默认登录名-admin-zabbix-切记admin-a是大写" tabindex="-1"><a class="header-anchor" href="#_1-2-1系统默认登录账号和密码-root-zabbix-网页默认登录名-admin-zabbix-切记admin-a是大写" aria-hidden="true">#</a> 1.2.1系统默认登录账号和密码： root :zabbix：网页默认登录名： Admin:zabbix（切记Admin ，A是大写）</h3><h3 id="_1-2-2安装查看ipconfig-yum-y-install-net-tools。-查看ip地址登录" tabindex="-1"><a class="header-anchor" href="#_1-2-2安装查看ipconfig-yum-y-install-net-tools。-查看ip地址登录" aria-hidden="true">#</a> 1.2.2安装查看ipconfig yum -y install net-tools。（查看ip地址登录）</h3><h3 id="_1-2-3开启-sshd-登录-systemctl-enable-sshd" tabindex="-1"><a class="header-anchor" href="#_1-2-3开启-sshd-登录-systemctl-enable-sshd" aria-hidden="true">#</a> 1.2.3开启 sshd 登录 systemctl enable sshd</h3><h3 id="_1-2-4安装中文输入法" tabindex="-1"><a class="header-anchor" href="#_1-2-4安装中文输入法" aria-hidden="true">#</a> 1.2.4安装中文输入法</h3><p>错误提示 You are not able to choose some of the languages, because locales for them are not installed on the web server.</p><p>dnf install langpacks-zh_CN.noarch</p><p>dnf install glibc-common</p><p>测试安装是否成功？</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[root@blog dejavu]# locale -a | grep zh_CN
zh_CN
zh_CN.gb18030
zh_CN.gbk
zh_CN.utf8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-1-4-重启服务" tabindex="-1"><a class="header-anchor" href="#_1-1-4-重启服务" aria-hidden="true">#</a> 1.1.4 重启服务</h3><p>systemctl restart zabbix-server</p><p>systemctl restart zabbix-server.service</p><h3 id="_1-2-客户端看着" tabindex="-1"><a class="header-anchor" href="#_1-2-客户端看着" aria-hidden="true">#</a> 1.2 客户端看着</h3><h3 id="_1-2-1windows-客户端" tabindex="-1"><a class="header-anchor" href="#_1-2-1windows-客户端" aria-hidden="true">#</a> 1.2.1windows 客户端</h3><p>https://www.jianshu.com/p/c300863ba7ad</p><h3 id="_1-2-2centos-安装-客户端" tabindex="-1"><a class="header-anchor" href="#_1-2-2centos-安装-客户端" aria-hidden="true">#</a> 1.2.2centos 安装 客户端</h3><h4 id="_1-2-2-1安装-zabbix-rpm-源" tabindex="-1"><a class="header-anchor" href="#_1-2-2-1安装-zabbix-rpm-源" aria-hidden="true">#</a> 1.2.2.1安装 zabbix rpm 源</h4><p>[root@zabbix ~]# rpm -Uvh https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/7/x86_64/zabbix-release-5.0-1.el7.noarch.rpm [root@zabbix ~]# sed -i &#39;s#http://repo.zabbix.com#https://mirrors.aliyun.com/zabbix#&#39; /etc/yum.repos.d/zabbix.repo #鉴于国内网络情况，使用阿里云 zabbix 源 [root@zabbix ~]# yum clean all</p><p>或者 安装： yum -y install zabbix-agent</p><h4 id="_1-2-2-2、修改配置文件-等号后内容自行更改" tabindex="-1"><a class="header-anchor" href="#_1-2-2-2、修改配置文件-等号后内容自行更改" aria-hidden="true">#</a> 1.2.2.2、修改配置文件（等号后内容自行更改）</h4><p>vi /etc/zabbix/zabbix_agentd.conf Server=127.0.0.1 #zabbix server的ip地址或主机名，可同时列出多个，需要用逗号隔开 ServerActive=127.0.0.1 #开启主动检查 Hostname=Zabbix server #在zabbix server前端配置时指定的主机名要相同，最重要的配置</p><h4 id="_1-2-2-3、启动服务" tabindex="-1"><a class="header-anchor" href="#_1-2-2-3、启动服务" aria-hidden="true">#</a> 1.2.2.3、启动服务</h4><p>systemctl start zabbix-agent systemctl enable zabbix-agent</p><h2 id="_1-3添加监控" tabindex="-1"><a class="header-anchor" href="#_1-3添加监控" aria-hidden="true">#</a> 1.3添加监控</h2><h3 id="_1-3-1监控snmp-设备" tabindex="-1"><a class="header-anchor" href="#_1-3-1监控snmp-设备" aria-hidden="true">#</a> 1.3.1监控snmp 设备</h3><p>https://www.cnblogs.com/struggle-1216/p/12361210.html</p><p>交换机参考</p><p>https://www.geek-share.com/detail/2761201844.html</p><p><strong>1.2 检查网络</strong></p><p>\\1. 网络策略没放通，可通过端口扫描工具nmap在Zabbix主机上来探测目标地址的路径是否通畅（注意：这里很多人会用ping和telnet来做通断探测，存在很大误区，首先ping是ICMP协议只能证明路由是否可达和snmp是否通讯没有关联何况有些网络环境是禁ping的，telnet探测的端口都是TCP端口，而snmp使用的是UDP端口，所以也不能作为端口是否开放的判断依据）</p><h3 id="_1-2-1-nmap" tabindex="-1"><a class="header-anchor" href="#_1-2-1-nmap" aria-hidden="true">#</a> 1.2.1 nmap</h3><blockquote><p># yum install -y nmap # nmap -sU 192.168.1.99 -p 161</p></blockquote><p>Nmap参数说明： -sU 表示使用UDP端口探测 IP：指定目的IP -p 表示端口号 Nmap返回状态说明：</p><h3 id="_1-2-2-snmpwalk" tabindex="-1"><a class="header-anchor" href="#_1-2-2-snmpwalk" aria-hidden="true">#</a> 1.2.2 snmpwalk</h3><p>yum -y install net-snmp-utils</p><p>snmpwalk -v 2c -c public 192.168.2.254 SNMPv2-MIB::sysDescr.0</p><p>配置参数有误和网络snmp不可达，则会出现：Timeout: No Response from 192.168.2.254</p><h3 id="_1-3-2vm添加监控" tabindex="-1"><a class="header-anchor" href="#_1-3-2vm添加监控" aria-hidden="true">#</a> 1.3.2vm添加监控</h3><p>https://www.cnblogs.com/FengGeBlog/p/12515835.html</p><h1 id="_2-错误解决" tabindex="-1"><a class="header-anchor" href="#_2-错误解决" aria-hidden="true">#</a> 2.错误解决</h1><h2 id="_2-1get-value-from-agent-failed-cannot-connect-to-192-168-10-240-10050-111-connection-refused" tabindex="-1"><a class="header-anchor" href="#_2-1get-value-from-agent-failed-cannot-connect-to-192-168-10-240-10050-111-connection-refused" aria-hidden="true">#</a> 2.1Get value from agent failed: cannot connect to [[192.168.10.240]:10050]: [111] Connection refused</h2><h3 id="_2-1-1端口不通" tabindex="-1"><a class="header-anchor" href="#_2-1-1端口不通" aria-hidden="true">#</a> 2.1.1端口不通</h3><p>测试是否可以ping通</p><h3 id="_2-1-2-查看进程" tabindex="-1"><a class="header-anchor" href="#_2-1-2-查看进程" aria-hidden="true">#</a> 2.1.2 查看进程</h3><p>查看方法：ps -ef | grep zabbix 看是否有zabbix-agent的进程。</p><h3 id="_2-1-3-查看端口是否开启" tabindex="-1"><a class="header-anchor" href="#_2-1-3-查看端口是否开启" aria-hidden="true">#</a> 2.1.3 查看端口是否开启</h3><p>登陆agent端，执行语句 telnet 10.10.10.40 10051 查看端口是否开启 登陆server端，执行语句 telnet 10.20.30.40 10050 查看端口是否开启</p><h3 id="_2-1-4开启端口" tabindex="-1"><a class="header-anchor" href="#_2-1-4开启端口" aria-hidden="true">#</a> 2.1.4开启端口</h3><p>https://blog.csdn.net/weixin_38652136/article/details/80484637</p><p>2.1.4.1开启防火墙 systemctl start firewalld</p><p>2.1.4.2开放指定端口 firewall-cmd --zone=public --add-port=10050/tcp --permanent 命令含义： --zone #作用域 --add-port=80/tcp #添加端口，格式为：端口/通讯协议 --permanent #永久生效，没有此参数重启后失效</p><h4 id="_2-1-4-3重启防火墙" tabindex="-1"><a class="header-anchor" href="#_2-1-4-3重启防火墙" aria-hidden="true">#</a> 2.1.4.3重启防火墙</h4><p>​ firewall-cmd --reload</p><h4 id="_2-1-4-4查看端口号" tabindex="-1"><a class="header-anchor" href="#_2-1-4-4查看端口号" aria-hidden="true">#</a> 2.1.4.4查看端口号</h4><p>netstat -ntulp |grep 80 //查看所有80端口使用情况</p><h2 id="_2-2-zabbix-poller-processes-more-than-75-busy" tabindex="-1"><a class="header-anchor" href="#_2-2-zabbix-poller-processes-more-than-75-busy" aria-hidden="true">#</a> 2.2 Zabbix poller processes more than 75% busy”</h2><p>修改 zabbix_server.conf，找到配置StartPollers的段落：</p><p>StartPollers=10 //修改后还是报警，修改第二个参数</p><p>StartDiscoverers=5</p><p>UnavailableDelay=360</p><p>2.3 监控vmware 主机提示 Couldn&#39;t resolve host name</p><h1 id="_3-微信警告" tabindex="-1"><a class="header-anchor" href="#_3-微信警告" aria-hidden="true">#</a> 3.微信警告</h1><h1 id="_3-1安装程序" tabindex="-1"><a class="header-anchor" href="#_3-1安装程序" aria-hidden="true">#</a> 3.1安装程序</h1><p>yum install openssl-devel</p><p>(python3 安装)</p><p>yum install python3-pip</p><p>pip3 install redis pip3 install pymysql yum install gcc python3-devel pip3 install requests</p><h2 id="_3-2-微信配置文件下载" tabindex="-1"><a class="header-anchor" href="#_3-2-微信配置文件下载" aria-hidden="true">#</a> 3.2 微信配置文件下载</h2><p>yum -y install git git clone https://github.com/X-Mars/Zabbix-Alert-WeChat.git cp Zabbix-Alert-WeChat/wechat.py /usr/lib/zabbix/alertscripts/ cd /usr/lib/zabbix/alertscripts/ chmod +x wechat.py &amp;&amp; chown zabbix:zabbix wechat.py</p><h2 id="_3-3警告路径" tabindex="-1"><a class="header-anchor" href="#_3-3警告路径" aria-hidden="true">#</a> 3.3警告路径</h2><p>/usr/lib/zabbix/alertscripts/</p><h2 id="_3-4参考地址" tabindex="-1"><a class="header-anchor" href="#_3-4参考地址" aria-hidden="true">#</a> 3.4参考地址</h2><p>https://www.cnblogs.com/yaun1498078591/p/10238601.html</p><h1 id="_4-自发现" tabindex="-1"><a class="header-anchor" href="#_4-自发现" aria-hidden="true">#</a> 4.自发现</h1><p>https://www.cnblogs.com/huibaobao/p/13537794.html</p><p>https://blog.csdn.net/ht9999i/article/details/107417981</p><h2 id="_5-日志清理" tabindex="-1"><a class="header-anchor" href="#_5-日志清理" aria-hidden="true">#</a> 5.日志清理</h2><p>df 查看磁盘占用情况</p><p>发现 history_uint.ibd 文件过大</p><p><img src="`+r+'" alt="img"></p><p>User=&quot;sa&quot;</p><p>Passwd=&quot;xxx&quot;</p><p>Date=<code>date -d $(date -d &quot;-30 day&quot; +%Y%m%d) +%s</code></p><p>mysql -u${User} -p${Passwd} 2&gt; /dev/null -e &quot;</p><p>use zabbix;</p><p>DELETE FROM history WHERE &#39;clock&#39; &lt; $Date;</p><p>optimize local table history;</p><p>DELETE FROM history_uint WHERE &#39;clock&#39; &lt; $Date;</p><p>optimize local table history_uint;</p><p>DELETE FROM history_text WHERE &#39;clock&#39; &lt; $Date;</p><p>optimeze local table history_text;&quot;</p><p>添加自动执行任务</p><p>[root@localhost ~]<em># crontab -e</em> 0 2 * * 0 /root/mysql_clear/clear_his.sh</p><p>磁盘空间清理</p><p>du -h --max-depth=1 |grep &#39;G&#39; |sort</p>',99),h=[n];function d(p,o){return e(),t("div",null,h)}const c=a(s,[["render",d],["__file","zabbix.html.vue"]]);export{c as default};
